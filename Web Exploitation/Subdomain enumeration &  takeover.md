---
sort : 1 
--- 

# Subdomain Enumeration & Takeover

Subdomain enumeration is the process of finding valid (resolvable) subdomains for one or more domain(s), Unless the DNS server exposes a full DNS zone (via AFXR)

```note
`DNS zone transfer protocol`, also sometimes known by the inducing DNS query type `AXFR`, is a type of DNS transaction. It is one of the many mechanisms available for administrators to replicate DNS databases across a set of DNS servers. 
```

## Tools

### 1. [Sublist3r](https://github.com/aboul3la/Sublist3r)
you might encounter non-resolvable subdomains (domains responding with NXDOMAIN). This is because Sublist3r relies heavily on passive data and it doesn't validate whether the found subdomains really exist

```bash
$ python sublist3r.py -d example.com
```

### 2. theHarvester
finds e-mail addresses on target domains as well as subdomains and virtual hosts. However, compared to Sublist3r, it provides fewer subdomain results.

```bash
$ python theHarvester.py -d example.com -b all
```

### 3. Smart DNS Brute-Forcer (SDBF)
<br>


## Techniques

### 1. Zone transfer

The most simple and basic technique is to try an AXFR request directly on the DNS server:

```bash
$ dig @ns.example.com example=.com AXFR
```

The best practice advises administrators to allow AXFR requests only from authorized DNS servers, so the above technique will probably not work. But if it does, you have found a goldmine.


> see also Nmap Script [dns-nsec-enum](https://nmap.org/nsedoc/scripts/dns-nsec-enum.html)


### 2. Google Dorking

We can use the site operator to find all subdomains that Google has found

```
site:example.com
```

### 3. Rapid7 DNS dataset ==> DNSDumpster

https://dnsdumpster.com/ 


### 4. Subject Alternative Name (SAN)

is an extension in x.509 certificates to provide different names of the subject in one certificate. Companies often generate one certificate for multiple subdomains to save money.

We can look into certificates to hunt for subdomains in SAN's using two different sources:  

#### Censys.io

```
https://censys.io/certificates?q=.example.com
```

#### Crt.sh

```
https://crt.sh/?q=%25.example.com
```


# References 
- [Sweepatic Blog - The Art of Subdomain Enumeration](https://blog.sweepatic.com/art-of-subdomain-enumeration/)