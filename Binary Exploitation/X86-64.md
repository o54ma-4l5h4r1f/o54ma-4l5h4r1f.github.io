---
sort : 5
---


# X86-64 Architecture Guide


|     Register     |                     Purpose                     | Saved across calls |
|:----------------:|:-----------------------------------------------:|:------------------:|
| %rax             | temp register; return value                     | No                 |
| %rbx             | callee-saved                                    | Yes                |
| %rcx             | used to pass 4th argument to functions          | No                 |
| %rdx             | used to pass 3rd argument to functions          | No                 |
| %rsp             | stack pointer                                   | Yes                |
| %rbp             | callee-saved; base pointer                      | Yes                |
| %rsi             | used to pass 2nd argument to functions          | No                 |
| %rdi             | used to pass 1st argument to functions          | No                 |
| %r8              | used to pass 5th argument to functions          | No                 |
| %r9              | used to pass 6th argument to functions          | No                 |
| %r10-r11         | temporary                                       | No                 |
| %r12-r15         | callee-saved registers                          | Yes                |


```tip
call fun(di, si, dx, cx, 8, 9)
```





## Examples
```nasm
cmp    bl, 78h
jg     addr    ; if bl > 78h, jump to addr
```



```

rep stosq qword [rdi]  {0x0}  {0x0}  {0x0}                 ????????????????????/

```




|        Opcode        |                                                                                                           Description                        |
|:--------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------:|
| Copying values       |                                                                                                                                              |
| mov src, dest        | Copies a value from a register, immediate value or memory address to a register or memory address.                                           |
| cmove %src, %dest    | Copies from register %src to register %dest if the last comparison operation had the corresponding result.                                   |
| cmovne %src, %dest   |  (cmove: equality, cmovne: inequality, cmovg: greater, cmovl: less, cmovge: greater or equal, cmovle: less or equal)                         |
| cmovg %src, %dest    |                                                                                                                                              |
| cmovl %src, %dest    |                                                                                                                                              |
| cmovge %src, %dest   |                                                                                                                                              |
| cmovle %src, %dest   |                                                                                                                                              |

| Stack management     |                                                                                                                                              |
| leave                | Removes local variables from the stack frame by restoring the old values of %rsp and %rbp.                                                   |
| push src             | Decreases %rsp and places src at the new memory location pointed to by %rsp. Here, src can be a register, immediate value or memory address. |
| pop dest             | Copies the value stored at the location pointed to by %rsp to dest and increases %rsp. Here, dest can be a register or memory location.      |

| Control flow         |                                                                                                                                              |
| call target          | Jump unconditionally to target and push return value (current PC + 1) onto stack.                                                            |
| ret                  | Pop the return address off the stack and jump unconditionally to this address.                                                               |
| jmp target           | Jump unconditionally to target, which is specified as a memory location (for example, a label).                                              |
| je target            | Jump to target if the last comparison had the corresponding result (je: equality; jne: inequality).                                          |
| jne target           |                                                                                                                                              |

| Arithmetic and logic |                                                                                                                                              |
| add src, dest        | Add src to dest.                                                                                                                             |
| sub src, dest        | Subtract src from dest.                                                                                                                      |
| imul src, dest       | Multiply dest by src.                                                                                                                        |
| idiv divisor         | Divide rdx:rax by divisor.  Store quotient in rax and store remainder in rdx.                                                                |
| shr reg              | Shift reg to the left or right by value in cl (low 8 bits of rcx).                                                                           |
| shl reg              |                                                                                                                                              |
| ror src, dest        | Rotate dest to the left or right by src bits.                                                                                                |
| cmp src, dest        | Set flags corresponding to whether dest is less than, equal to, or greater than src                                                          |



src and dest ?????? swap them ?? 










see this https://www.thesecuritybuddy.com/reverse-engineering/what-is-fs0x28-in-x86-assembly/2/


## Ref

* http://6.s081.scripts.mit.edu/sp18/x86-64-architecture-guide.html