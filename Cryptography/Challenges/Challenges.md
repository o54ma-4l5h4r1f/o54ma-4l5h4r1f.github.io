---
sort : 2
---

# Challenges

## [Adrien's Signs](https://cryptohack.org/courses/modular/adrien/)

> Source.py

```python
from random import randint

a = 288260533169915
p = 1007621497415251

FLAG = b'crypto{????????????????????}'


def encrypt_flag(flag):
	ciphertext = []
	plaintext = ''.join([bin(i)[2:].zfill(8) for i in flag])
	for b in plaintext:
		e = randint(1, p)
		n = pow(a, e, p)
		if b == '1':
			ciphertext.append(n)
		else:
			n = -n % p
			ciphertext.append(n)
	return ciphertext


print(encrypt_flag(FLAG))
```





> Output.txt

<details markdown="1" style="dispaly=flex;"><summary>Click To View</summary>

<div markdown="1" style="font-size:xx-small">

```
[67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]
```

</div>

</details>



> Code Analysis

<details markdown="1" style="dispaly=flex;"><summary>Click To View</summary>

<div markdown="1">

```python
# we are having 2 numbers "a & p" and 7 known characters from the FLAG "crypto{"

# inside the "encrypt_flag" function :
'''
for each ord(char) in the flag, get the binary format of it with "bin(i)" (e.g. bin(ord('A')) = '0b101001')

then take only the binary number after the "0b" chars with [2:]

then fill left of the binary with a padding zeros to make it 8 bits binary with .zfill(8)  

then concatenate all the binary numbers into one long binary as a string called the plaintext 

now for every bit "b" in the plaintext, we will generate a random number between "1 and p (prime)" called "e" and calculate "n" out of it "n = pow(a, e, p)"

if the bit "b" = '1':
	we will append the number "n" into the ciphertext array  

else :
	we will append the "n" multiplied by -1 modulo "p"
'''


# so the givin output is an array of the appended "n or -n%p" values
```
<br>

<img  src="https://latex.codecogs.com/svg.image?\text{Since} \ n = a^{e} \mod p \ , \ \ \text{where} \ p \ \text{is a prime number and } 1 \leqslant e \leqslant p"/>

<br>

<img  src="https://latex.codecogs.com/svg.image?\text{then} \ a^{e} \equiv n \ (mod\ p)"/>

<br>

<img  src="https://latex.codecogs.com/svg.image?\text{sine we can represent } a^{e} \ \text{as} \ (a^{ \frac{e}{2} })^{2}"/>

<br>

<img  src="https://latex.codecogs.com/svg.image?\text{then } n \text{ is always a quadratic residue mod } p"/>

---

<img  src="https://latex.codecogs.com/svg.image?\text{Knowing the Legendre symbol methodology }"/>	

<br>

<img  src="https://latex.codecogs.com/svg.image? 1 \equiv \frac{q}{p} \equiv q^{(\frac{p-1}{2})} \ (mod\ p) \ \ \leftarrow \text{only when } q \text{ is quadratic residue mod } p"/>

---

<img  src="https://latex.codecogs.com/svg.image?\text{So if } n^{(\frac{p-1}{2})} \ mod\ p = 1   \ \ \rightarrow n \text{ quadratic residue mod } p \rightarrow \text{the corresponding bit is '1'}"/>	

<br>

<img  src="https://latex.codecogs.com/svg.image?\text{else } \rightarrow n \text{ quadratic non-residue mod } p \rightarrow \text{the corresponding bit is '0'}"/>	

<p> How ?? </p>

<img  src="https://latex.codecogs.com/svg.image?\text{we know that } -1 \equiv p-1 \ (mod\ p) \ , \ \text{and we find out } p-1 \text{ is quadratic non-residue}"/>	

<p> and from the properties of quadratic (non-)residues </p>

<img  src="https://latex.codecogs.com/svg.image?\text{Quadratic Residue} \times \text{Quadratic Non-Residue = Quadratic Non-Residue}"/>

<p> Thats Why </p>

<img  src="https://latex.codecogs.com/svg.image?\ \{n\} \text{ is Quadratic Residue and } \{(-1 \times n) \ mod\ p\} \text{ is Quadratic Non-Residue}"/>

</div>

</details>


> Solution.py

<details markdown="1" style="dispaly=flex;"><summary>Click To View</summary>

<div markdown="1">

```python
import json
import binascii

output = open('output.txt')
ciphertext = json.load(output)

p = 1007621497415251
FLAG = '0b'

for n in ciphertext:
	if pow(n, (p-1)//2, p) == 1:
		FLAG += '1'
	else:
		FLAG += '0'

FLAG = binascii.unhexlify('%x' % int(FLAG, 2))

print(FLAG)
```

</div>

</details>











<!-- 

https://cryptohack.org/challenges/marin/solutions/

```python
from Crypto.Util.number import *


n= 658416274830184544125027519921443515789888264156074733099244040126213682497714032798116399288176502462829255784525977722903018714434309698108208388664768262754316426220651576623731617882923164117579624827261244506084274371250277849351631679441171018418018498039996472549893150577189302871520311715179730714312181456245097848491669795997289830612988058523968384808822828370900198489249243399165125219244753790779764466236965135793576516193213175061401667388622228362042717054014679032953441034021506856017081062617572351195418505899388715709795992029559042119783423597324707100694064675909238717573058764118893225111602703838080618565401139902143069901117174204252871948846864436771808616432457102844534843857198735242005309073939051433790946726672234643259349535186268571629077937597838801337973092285608744209951533199868228040004432132597073390363357892379997655878857696334892216345070227646749851381208554044940444182864026513709449823489593439017366358869648168238735087593808344484365136284219725233811605331815007424582890821887260682886632543613109252862114326372077785369292570900594814481097443781269562647303671428895764224084402259605109600363098950091998891375812839523613295667253813978434879172781217285652895469194181218343078754501694746598738215243769747956572555989594598180639098344891175879455994652382137038240166358066403475457 
e= 65537
c= 400280463088930432319280359115194977582517363610532464295210669530407870753439127455401384569705425621445943992963380983084917385428631223046908837804126399345875252917090184158440305503817193246288672986488987883177380307377025079266030262650932575205141853413302558460364242355531272967481409414783634558791175827816540767545944534238189079030192843288596934979693517964655661507346729751987928147021620165009965051933278913952899114253301044747587310830419190623282578931589587504555005361571572561916866063458812965314474160499067525067495140150092119620928363007467390920130717521169105167963364154636472055084012592138570354390246779276003156184676298710746583104700516466091034510765027167956117869051938116457370384737440965109619578227422049806566060571831017610877072484262724789571076529586427405780121096546942812322324807145137017942266863534989082115189065560011841150908380937354301243153206428896320576609904361937035263985348984794208198892615898907005955403529470847124269512316191753950203794578656029324506688293446571598506042198219080325747328636232040936761788558421528960279832802127562115852304946867628316502959562274485483867481731149338209009753229463924855930103271197831370982488703456463385914801246828662212622006947380115549529820197355738525329885232170215757585685484402344437894981555179129287164971002033759724456

# p = 1 << 2000
# for i in range(1000):
#     print(i)
#     q = 1 << 2000
#     for j in range(1000):
#         if (p-1) * (q-1) == n:
#             print((p-1), (q-1))
#             exit(0)
#         q = q << 1
#     p = p << 1


p = 1 << 2
while n % (p - 1) != 0:
    p <<= 1

p -= 1

q = n // p 




p = 1475979915214180235084898622737381736312066145333169775147771216478570297878078949377407337049389289382748507531496480477281264838760259191814463365330269540496961201113430156902396093989090226259326935025281409614983499388222831448598601834318536230923772641390209490231836446899608210795482963763094236630945410832793769905399982457186322944729636418890623372171723742105636440368218459649632948538696905872650486914434637457507280441823676813517852099348660847172579408422316678097670224011990280170474894487426924742108823536808485072502240519452587542875349976558572670229633962575212637477897785501552646522609988869914013540483809865681250419497686697771007

q = 446087557183758429571151706402101809886208632412859901111991219963404685792820473369112545269003989026153245931124316702395758705693679364790903497461147071065254193353938124978226307947312410798874869040070279328428810311754844108094878252494866760969586998128982645877596028979171536962503068429617331702184750324583009171832104916050157628886606372145501702225925125224076829605427173573964812995250569412480720738476855293681666712844831190877620606786663862190240118570736831901886479225810414714078935386562497968178729127629594924411960961386713946279899275006954917139758796061223803393537381034666494402951052059047968693255388647930440925104186817009640171764133172418132836351

phi = (p-1) * (q-1)

d = pow(e, -1, phi)

print(long_to_bytes(pow(c, d, n)))
```

 -->




<br>
<br>